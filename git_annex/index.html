<!doctype html><html><title>Git Annex - Setup and Workflow</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=apple-mobile-web-app-capable content="yes"><link href=/favicon.ico rel=icon type=image/x-icon><link rel=stylesheet href=/digital-garden/css/index.min.a0895bb654e8045ccd7c076b90424630ff257a211f1f8c4796076f6e1356bcec.css><style type=text/css>:root{--color:#333;--background-color:#fafafa;--line-height:1.4;--font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";--header-background-color:#ffffff;--header-border-bottom-color:#ccc;--header-color:#000000;--page-background-color:#ffffff;--page-border-left-color:rgba(0, 0, 0, 0.05);--page-link-color:rgba(10, 132, 255, 1);--page-max-width:625px;--page-font-size:17px;--page-line-height:24px;--page-hr-background-color:#dddddd;--backlinks-background-color:#fafafc;--backlinks-border-radius:16px;--backlink-label-color:#888888;--backlink-title-color:#000000;--backlink-preview-color:rgb(102, 102, 102);--backlink-hover-background-color:rgba(0, 0, 0, 0.05);--preview-width:625px;--preview-max-height:400px;--preview-scale:0.8;--preview-box-shadow-top-color:rgba(0, 0, 0, 0.08);--preview-box-shadow-right-color:rgba(0, 0, 0, 0.04);--preview-box-shadow-bottom-color:rgba(0, 0, 0, 0.15);--preview-box-shadow-left-color:rgba(0, 0, 0, 0.04);--search-extract-color:#aaaaaa}</style><body><header><a href=/ id=logo-and-title><div class=site-logo></div><div class=site-title>Nilavara</div></a></header><div class=grid-container><div class=grid><div class=page data-level=1><div class=content><h1>Git Annex - Setup and Workflow</h1><h2 id=what-is-git-annex>What is git annex?</h2><ul><li><a href=https://git-annex.branchable.com/>Git Annex</a> is an open source software written in haskell. It provides a layer over Git to manage large and binary which are otherwise not checked into Git.</li><li>For me, git-annex is a software that enables me to see what all files are stored in all my hard-drives when they are not connected. It also acts as an interface to retrieve those files, add files, and create multiple copies stored in different hard-drives.</li></ul><h2 id=how-to-install-git-annex-in-arch-linux>How to install git annex in Arch Linux</h2><ul><li>Install <code>git-annex-standalone</code> from pacman or download linux version from its webpage and run install script.<ul><li>DO NOT install <code>git-annex</code> - ONLY install <code>git-annex-standalone</code>. The former will install all haskell libraries which is heavy and reuqires frequent updates.</li></ul></li></ul><h2 id=how-to-set-up-folders-in-laptop-and-external-hdd-for-synchronizing>How to set up folders in laptop and external-HDD for synchronizing?</h2><ul><li>Create a source folder in laptop, and destination folder in external-HDD</li><li>Run init commands in each folder and add complementary folder as remote</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd source-folder
</span></span><span style=display:flex><span>git init
</span></span><span style=display:flex><span>git annex init <span style=color:#e6db74>&#34;source&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd destination-folder
</span></span><span style=display:flex><span>git init
</span></span><span style=display:flex><span>git annex init <span style=color:#e6db74>&#34;destination&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd source-folder
</span></span><span style=display:flex><span>git remote add <span style=color:#e6db74>&#34;destination&#34;</span> destination-folder
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd destination-folder
</span></span><span style=display:flex><span>git remote add <span style=color:#e6db74>&#34;source&#34;</span> source-folder
</span></span></code></pre></div><h2 id=how-to-move-all-files-to-destination-folder-leaving-only-metadata-in-source-folder>How to move all files to destination-folder, leaving only metadata in source-folder</h2><ul><li>Add files to git-annex in source-folder, run sync from each folder and move.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd source-folder
</span></span><span style=display:flex><span>git annex add .
</span></span><span style=display:flex><span>git commit -a -m <span style=color:#e6db74>&#34;My commit message&#34;</span>
</span></span><span style=display:flex><span>git annex sync
</span></span><span style=display:flex><span>git annex move . --to <span style=color:#e6db74>&#34;destination&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd destination-folder
</span></span><span style=display:flex><span>git annex sync
</span></span></code></pre></div><h2 id=what-special-instructions-does-calibre-library-folder-require-during-setup-and-syncing>What special instructions does calibre-library folder require during setup and syncing</h2><ul><li>During setup, add the following lines to <code>.gitignore</code> files in both source-folder and destination folder.</li></ul><pre tabindex=0><code>metadata_db_prefs_backup.json
metadata.db
-.jpg
-.opf
</code></pre><ul><li>Also during setup, run the following commands once from source-folder and once from destination folder.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git config annex.largefiles <span style=color:#e6db74>&#34;include=* exclude=*.opf exclude=*.json exclude=*.db exclude=*.jpg&#34;</span>
</span></span></code></pre></div><ul><li>During synchronization, run the following command while in source-folder</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>rsync -av --delete --exclude<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.git/&#34;</span> --include <span style=color:#e6db74>&#39;*.jpg&#39;</span> --include <span style=color:#e6db74>&#39;*.opf&#39;</span> --include <span style=color:#e6db74>&#39;metadata*&#39;</span> --include<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;*/&#34;</span> --exclude<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;*&#34;</span>  . destination-folder
</span></span></code></pre></div><h2 id=how-to-retrieve-a-file-from-external-hdd>How to retrieve a file from external-HDD?</h2><ul><li>Run <code>get</code> command from source folder</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd source-folder
</span></span><span style=display:flex><span>git annex get <span style=color:#e6db74>&#34;myfile&#34;</span>
</span></span></code></pre></div><h2 id=how-to-find-the-location-where-files-is-stored>How to find the location where files is stored?</h2><ul><li>Run whereis command from any of git-annex folders</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git annex whereis <span style=color:#e6db74>&#34;myfile&#34;</span>
</span></span></code></pre></div></div></div></div></div><script src=https://ibnishak.github.io/digital-garden/js/URI.js type=text/javascript></script>
<script src=https://ibnishak.github.io/digital-garden/js/page.js type=text/javascript></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>